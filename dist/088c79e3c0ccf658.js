import"./style.css";import*as THREE from"three";import*as dat from"lil-gui";import{GLTFLoader}from"three/examples/jsm/loaders/GLTFLoader.js";import{DRACOLoader}from"three/examples/jsm/loaders/DRACOLoader.js";function inet(){gsap.registerPlugin(ScrollTrigger);const e=new LocomotiveScroll({el:document.querySelector("#main"),smooth:!0});e.on("scroll",ScrollTrigger.update),ScrollTrigger.scrollerProxy("#main",{scrollTop(t){return arguments.length?e.scrollTo(t,0,0):e.scroll.instance.scroll.y},getBoundingClientRect:()=>({top:0,left:0,width:window.innerWidth,height:window.innerHeight}),pinType:document.querySelector("#main").style.transform?"transform":"fixed"})}inet();const textureLoader=new THREE.TextureLoader,floorterrain=textureLoader.load("/textures/terrain-normal.jpg"),floorrough=textureLoader.load("/textures/terrain-roughness.jpg"),cubetexture=new THREE.CubeTextureLoader,env=cubetexture.load(["/textures/environmentMaps/1/px.jpg","/textures/environmentMaps/1/nx.jpg","/textures/environmentMaps/1/py.jpg","/textures/environmentMaps/1/ny.jpg","/textures/environmentMaps/1/pz.jpg","/textures/environmentMaps/1/nz.jpg"]),dracoLoader=new DRACOLoader;dracoLoader.setDecoderPath("/draco/"),dracoLoader.setDecoderConfig({type:"wasm",url:"/draco/draco_decoder.wasm"});const gltfLoader=new GLTFLoader;gltfLoader.setDRACOLoader(dracoLoader);const canvas=document.querySelector("canvas.webgl"),scene=new THREE.Scene,sizes={width:window.innerWidth,height:window.innerHeight},camera=new THREE.PerspectiveCamera(75,sizes.width/sizes.height);camera.position.z=70,camera.position.y=15,scene.add(camera);const renderer=new THREE.WebGLRenderer({canvas,antialias:!0});renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),renderer.physicallyCorrectLights=!0,renderer.outputEncoding=THREE.sRGBEncoding,env.encoding=THREE.sRGBEncoding,renderer.shadowMap.enabled=!0,renderer.toneMappingExposure=2,renderer.setClearColor("black");const fog=new THREE.Fog("black",50,130);scene.fog=fog;const gui=new dat.GUI({width:400,height:400,scale:2}),Debugobj={intensity:1};gui.add(Debugobj,"intensity").max(10).min(1).step(1).name("intensityEnvMap").onChange(updateMaterial),gui.add(renderer,"toneMapping",{No:THREE.NoToneMapping,Linaer:THREE.LinearToneMapping,Reinhard:THREE.ReinhardToneMapping,cineon:THREE.CineonToneMapping,ACESFilmicg:THREE.ACESFilmicToneMapping});const directionlight=new THREE.DirectionalLight("#ffffff",15);directionlight.position.set(-5.763,40,-2.25),scene.add(directionlight),directionlight.castShadow=!0,directionlight.shadow.mapSize.width=2048,directionlight.shadow.mapSize.height=2048,directionlight.shadow.camera.left=-50,directionlight.shadow.camera.right=50,directionlight.shadow.camera.top=50,directionlight.shadow.camera.bottom=-50,directionlight.shadow.camera.near=.5,directionlight.shadow.camera.far=500;const DirectionalLightHelper=new THREE.DirectionalLightHelper(directionlight,.2);gui.add(directionlight,"intensity").min(0).max(25).step(.001).name("lightIntensity"),gui.add(directionlight.position,"x").min(-50).max(50).step(.001).name("lightX"),gui.add(directionlight.position,"y").min(-50).max(50).step(.001).name("lightY"),gui.add(directionlight.position,"z").min(-50).max(50).step(.001).name("lightZ");const ambientLight=new THREE.AmbientLight("#b9d5ff",.12);gui.add(ambientLight,"intensity").min(0).max(10).step(.001),scene.add(ambientLight);const floor=new THREE.Mesh(new THREE.PlaneGeometry(400,400),new THREE.MeshStandardMaterial({color:"#111",normalMap:floorterrain,roughnessMap:floorrough,roughness:.8,metalness:1}));floor.geometry.setAttribute("uv2",new THREE.Float32BufferAttribute(floor.geometry.attributes.uv.array,2)),floorrough.repeat.set(2,2),floorterrain.repeat.set(5,5),floor.receiveShadow=!0,floorterrain.wrapS=THREE.RepeatWrapping,floorrough.wrapT=THREE.RepeatWrapping,floor.rotation.x=.5*-Math.PI,floor.position.y=-12.5,scene.add(floor);let carPaintMesh=null,carTyreMesh=null;function updateMaterial(){scene.traverse((e=>{e instanceof THREE.Mesh&&e.material instanceof THREE.MeshStandardMaterial&&(e.material.envMap=env,e.material.envMapIntensity=Debugobj.intensity,e.castShadow=!0,e.receiveShadow=!0),e.isMesh&&"EXT_Carpaint.004"===e.material.name&&(carPaintMesh=e,carPaintMesh.material.color.set("white")),e.isMesh&&"EXT_Tyre.004"===e.material.name&&(carTyreMesh=e)}))}function changeCarPaintColor(e){carPaintMesh&&carPaintMesh.material.color.set(e)}gltfLoader.load("/models/scene.glb",(e=>{e.scene.scale.set(25,25,25),e.scene.position.set(0,0,0),e.scene.rotation.y=Math.PI/2,scene.add(e.scene),gui.add(e.scene.rotation,"y").min(-Math.PI).max(Math.PI).step(.001).name("Rotation"),gui.add(e.scene.position,"x").min(0).max(100).step(.001).name("Rotation"),gui.add(e.scene.position,"y").min(0).max(100).step(.001).name("Rotation"),gui.add(e.scene.position,"z").min(0).max(100).step(.001).name("Rotation"),gui.add(e.scene.scale,"x").min(0).max(100).step(.001).name("Rotation"),gui.add(e.scene.scale,"y").min(0).max(100).step(.001).name("Rotation"),gui.add(e.scene.scale,"z").min(0).max(100).step(.001).name("Rotation"),updateMaterial()}));const clock=new THREE.Clock;function animate(){const e=.1*clock.getElapsedTime();camera.position.x=65*Math.cos(e),camera.position.z=65*Math.sin(e),camera.lookAt(0,0,0),renderer.render(scene,camera),requestAnimationFrame(animate)}animate(),window.addEventListener("resize",(()=>{sizes.width=window.innerWidth,sizes.height=window.innerHeight,camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))})),document.querySelectorAll("button[data-color]").forEach((e=>{e.addEventListener("click",(()=>{changeCarPaintColor(e.getAttribute("data-color"))}))}));const leftBox1=document.getElementById("infoone"),leftBox2=document.getElementById("infothree"),rightBox1=document.getElementById("infotwo"),rightBox2=document.getElementById("infofour"),leftButton1=document.getElementById("select1"),leftButton2=document.getElementById("select2"),rightButton1=document.getElementById("select3"),rightButton2=document.getElementById("select4");let left1Toggled=!1,left2Toggled=!1,right1Toggled=!1,right2Toggled=!1;function closeAllDivs(){gsap.to(leftBox1,{transform:"translateX(-100%)",duration:1,ease:"power1.out"}),gsap.to(leftBox2,{transform:"translateX(-100%)",duration:1,ease:"power1.out"}),gsap.to(rightBox1,{transform:"translateX(100%)",duration:1,ease:"power1.out"}),gsap.to(rightBox2,{transform:"translateX(100%)",duration:1,ease:"power1.out"}),left1Toggled=!1,left2Toggled=!1,right1Toggled=!1,right2Toggled=!1}leftButton1.addEventListener("click",(()=>{closeAllDivs(),left1Toggled=!left1Toggled,gsap.to(leftBox1,{transform:left1Toggled?"translateX(0%)":"translateX(-100%)",duration:1,ease:"power1.out"}),left1Toggled&&setTimeout((()=>{gsap.to(leftBox1,{transform:"translateX(-100%)",duration:1,ease:"power1.out"}),left1Toggled=!1}),1e4)})),leftButton2.addEventListener("click",(()=>{closeAllDivs(),left2Toggled=!left2Toggled,gsap.to(leftBox2,{transform:left2Toggled?"translateX(0%)":"translateX(-100%)",duration:1,ease:"power1.out"}),left2Toggled&&setTimeout((()=>{gsap.to(leftBox2,{transform:"translateX(-100%)",duration:1,ease:"power1.out"}),left2Toggled=!1}),1e4)})),rightButton1.addEventListener("click",(()=>{closeAllDivs(),right1Toggled=!right1Toggled,gsap.to(rightBox1,{transform:right1Toggled?"translateX(0%)":"translateX(100%)",duration:1,ease:"power1.out"}),right1Toggled&&setTimeout((()=>{gsap.to(rightBox1,{transform:"translateX(100%)",duration:1,ease:"power1.out"}),right1Toggled=!1}),1e4)})),rightButton2.addEventListener("click",(()=>{closeAllDivs(),right2Toggled=!right2Toggled,gsap.to(rightBox2,{transform:right2Toggled?"translateX(0%)":"translateX(100%)",duration:1,ease:"power1.out"}),right2Toggled&&setTimeout((()=>{gsap.to(rightBox2,{transform:"translateX(100%)",duration:1,ease:"power1.out"}),right2Toggled=!1}),1e4)}));